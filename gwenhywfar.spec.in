%define name gwenhywfar
%define version @rpm_version@
%define release @rpm_release@
%define rpm_cxxflags \"-O2 -march=i486 -mcpu=i586\"
%define rpm_cflags \"-O2 -march=i486 -mcpu=i586\"


# Note: All commands below use %{_prefix}, which is rpm's system
# default prefix (as defined in /usr/lib/rpm/macros), so this variable
# is not used inside this spec file.
#%define prefix @prefix@

Summary: A multi-platform helper library for other libraries
Name: %{name}
Version: %{version}
Release: %{release}
Source: http://download.sourceforge.net/gwenhywfar/%{name}-%{version}.tar.gz
Requires: openssl 
Group: Libraries/System
Copyright: LGPL
Packager: Martin Preuss <martin@libchipcard.de>
URL: http://sourceforge.net/projects/gwenhywfar
BuildRoot: %{_tmppath}/%{name}-%{version}-root
Prereq: /sbin/ldconfig
Prefix: %{_prefix}

%description
This is Gwenhywfar, a multi-platform helper library for networking and
security applications and libraries. It is heavily used by libchipcard
www.libchipcard.de and OpenHBCI-TNG (The Next Generation)
www.openhbci.de.

%package devel
Summary: Gwenhywfar development kit
Group: Development/Libraries
%description devel
This package contains gwenhywfar-config and header files for writing and
compiling programs using Gwenhywfar.


%prep
%setup -q

%build
CXXFLAGS=%{rpm_cxxflags} CFLAGS=%{rpm_cflags}  \
  ./configure --prefix=%{_prefix} \
              --libdir=%{_libdir} --datadir=%{_datadir} \
              --includedir=%{_includedir}

make

%install
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT
LIBRARY_PATH=$RPM_BUILD_ROOT%{_libdir} make DESTDIR=$RPM_BUILD_ROOT \
  install

%clean
[ "$RPM_BUILD_ROOT" != "/" ] && rm -rf $RPM_BUILD_ROOT

%post
/sbin/ldconfig

%postun
/sbin/ldconfig

%files
%defattr(-,root,root,0755)
%doc README COPYING ChangeLog RELEASES
%{_libdir}/*.a
%{_libdir}/*.so
%{_libdir}/*.so.*

%files devel
%defattr(-,root,root,0755)
%doc README COPYING ChangeLog RELEASES
%{_bindir}/gwenhywfar-config
%{_includedir}/*
%{_libdir}/*.la
%{_datadir}/aclocal/gwenhywfar.m4


%changelog

